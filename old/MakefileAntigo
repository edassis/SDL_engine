#CC specifies which compiler we're using
CC = g++

# Directories
SRC_DIRS = src/engine src/application
BUILD_DIR = build

INC_DIR = header

VPATH = $(SRC_DIRS) # Do Makefile add these directories in scope

TARGET = $(BUILD_DIR)/MySDLProgram

# Files
SRCS := $(foreach dir, $(SRC_DIRS), $(wildcard $(dir)/*.cpp))
OBJS := $(addprefix $(BUILD_DIR)/,$(notdir $(SRCS:.cpp=.o)))

SDL_PATHS = C:/dev/SDL2-2.0.16/x86_64-w64-mingw32

SDL_INC_PATH = $(addsuffix /include,$(SDL_PATHS))
LIBRARY_PATHS = $(addprefix -L,$(addsuffix /lib,$(SDL_PATHS)))
# INCLUDE_PATHS specifies the additional include paths we'll need
INCLUDE_PATHS = -I$(INC_DIR) $(addprefix -I,$(SDL_INC_PATH))
# INCLUDE_PATHS = -Iheader

# LIBRARY_PATHS specifies the additional library paths we'll need
# LIBRARY_PATHS = -LC:\msys64\mingw64\lib

# COMPILER_FLAGS specifies the additional compilation options we're using
# 	-w suppresses all warnings
# 	-Wl,-subsystem,windows gets rid of the console window
# COMPILER_FLAGS = -w -Wl,-subsystem,windows
COMPILER_FLAGS = -g -O0 -Wall -lm -std=c++11

#LINKER_FLAGS specifies the libraries we're linking against
LIBS = -lmingw32 -lSDL2main -lSDL2_image -lSDL2_mixer -lSDL2_ttf -lSDL2

# $(info $$OBJS is [${OBJS}])

.PHONY: all

all: $(TARGET)

$(TARGET): $(OBJS)
	$(CC) $(COMPILER_FLAGS) $(LIBRARY_PATHS) $(LIBS) $^ -o $@

$(BUILD_DIR)/%.o: %.cpp | $(BUILD_DIR)
	$(CC) $(COMPILER_FLAGS) $(INCLUDE_PATHS) -c $< -o $@

$(BUILD_DIR):
	mkdir -p $@

help: 
	@echo $(SDL_INC_PATH)

exec: $(BIN)
	$(BIN).exe

clean:
	@$(RM) -rv $(BUILD_DIR)/* $(BUILD_DIR)